<%- include('partials/header', { title: 'Page profil public de ' + profile.display_name,
  description: 'Découvrez le profil public de ' + profile.display_name, bodyClass:'public-profile-page' }) %>

  <!-- ici c'est la page profil public d'un expert en détail (lien : /profil/:id) -->

  <main class="public-profile-main">
    <section class="card">
      <!-- <div class="card__image">
        <img src="/assets/img/profile-img.png" alt="Portrait de Marie Dupont" />
      </div> -->
      <div class="card__info">
        <h1 class="card__name">
          <%= profile.firstname %>
        </h1>
        <h1 class="card__name">
          <%= profile.lastname %>
        </h1>
        <p class="card__location">
          <%= profile.address %>
        </p>
        <p class="card__location">
          <%= profile.city %>
        </p>
        <p class="card__location">
          <%= profile.zipcode %>
        </p>
        <p class="card__location">
          <%= profile.company_identification_system %>
        </p>
        <p class="card__bio">
          <%= profile.description %>
        </p>
      </div>


      <!-- penser à écrire que pour faire une demande de connexion, l'utilisateur doit d'abord être inscrit et connecté sur seo sympa -->

      <!-- si l'utilisateur connecté est le même que l'utilisateur dont le profil est visité, alors demande de connexion impossible  -->

      <% if (session?.userId && profile.user_id !==session.userId) { %>
        <% if (!relation) { %>
          <form action="/relation" method="POST" class="relation-form">
            <button type="submit" class="button card__contact">Vous souhaitez rejoindre mon réseau ?</button>
          </form>
          
          <!-- demande de relation déjà acceptée, on montre le profil entier avec le mail -->
          <% } else if (relation.status===accepted) { %>
            <p> Vous êtes déjà en relation avec ce profil </p>
            <p class="card__info">
              <%= user.email %>
            </p>
            
            <!-- demande de relation en attente -->
            <% } else if (relation.status==pending) { %>
  
              <p> Demande de connexion déjà en attente, merci de patienter pour la réponse.</p>
              <!--https://icons8.com/preloaders/en/circular-->
              <!-- demande de relation refusée, on affiche à nouveau le bouton de demande -->
              <% } else if (relation.status===rejected) { %>
                <form action="/relation" method="POST" class="relation-form">
                  <button type="submit" class="button card__contact">Vous souhaitez rejoindre mon réseau ?</button>
                </form>
                <% } %>
                  <% } else { %>


                    <p> Vous ne pouvez pas demander à vous connecter à votre propre réseau. </p>

                    <% } %>



                      <!-- 
                    <a href="/#" class="button card__contact">Vous souhaitez rejoindre mon réseau ?</a> -->
    </section>
  </main>

  <%- include('partials/footer') %>